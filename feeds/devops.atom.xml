<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Sergey Kospanov - DevOps</title><link href="/" rel="alternate"></link><link href="/feeds/devops.atom.xml" rel="self"></link><id>/</id><updated>2018-12-16T00:00:00+02:00</updated><subtitle>Personal Page</subtitle><entry><title>Making S3 files private in bulk</title><link href="/make-s3-files-private.html" rel="alternate"></link><published>2018-12-16T00:00:00+02:00</published><updated>2018-12-16T00:00:00+02:00</updated><author><name>Sergey Kospanov</name></author><id>tag:None,2018-12-16:/make-s3-files-private.html</id><summary type="html">&lt;p&gt;How to make all s3 files in a bucket private&lt;/p&gt;</summary><content type="html">&lt;p&gt;Have you ever needed to make all files in a certain AWS S3 bucket private? Here is
a short script, using &lt;code&gt;GNU parallel&lt;/code&gt; and &lt;code&gt;aws-cli&lt;/code&gt;, to do just that (replace BUCKET_NAME with the actual
name of the bucket):&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws s3 ls --recursive s3://BUCKET_NAME &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    cut -d&lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt; -f5- &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    awk &lt;span class="s1"&gt;&amp;#39;{print $NF}&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    parallel --lb &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;aws s3api put-object-acl --acl private --bucket BUCKET_NAME --key &amp;quot;{}&amp;quot;; echo &amp;quot;{}&amp;quot;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</content><category term="aws"></category><category term="s3"></category></entry></feed>